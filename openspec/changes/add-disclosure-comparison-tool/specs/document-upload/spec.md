## ADDED Requirements

### Requirement: マルチファイルアップロード
システムは、ユーザーが複数のPDFファイルを同時にアップロードできる機能を提供しなければならない（MUST）。

#### Scenario: 2つのPDFファイルを同時にアップロード
- **WHEN** ユーザーが2つのPDFファイルを選択してアップロードする
- **THEN** システムは両方のファイルを受け付け、処理を開始する
- **AND** アップロード進捗が表示される

#### Scenario: 5つのPDFファイルを同時にアップロード
- **WHEN** ユーザーが5つのPDFファイルを選択してアップロードする
- **THEN** システムは全てのファイルを受け付け、並列処理を開始する

#### Scenario: 上限を超えるファイル数のアップロード試行
- **WHEN** ユーザーが6つ以上のPDFファイルをアップロードしようとする
- **THEN** システムはエラーメッセージを表示する
- **AND** 「最大5ファイルまでアップロード可能です」というメッセージを表示する

### Requirement: ドラッグ&ドロップUI
システムは、ファイルのドラッグ&ドロップによるアップロード機能を提供しなければならない（MUST）。

#### Scenario: ドラッグ&ドロップでファイルをアップロード
- **WHEN** ユーザーがPDFファイルをドラッグしてドロップゾーンにドロップする
- **THEN** システムはファイルを受け付け、処理を開始する
- **AND** ドロップゾーンに視覚的なフィードバックを表示する

#### Scenario: 無効なファイル形式のドラッグ&ドロップ
- **WHEN** ユーザーがPDF以外のファイル（例: .docx, .xlsx）をドロップする
- **THEN** システムはファイルを拒否する
- **AND** 「PDFファイルのみアップロード可能です」というエラーメッセージを表示する

### Requirement: ファイル形式の検証
システムは、アップロードされたファイルがPDF形式であることを検証しなければならない（MUST）。

#### Scenario: 有効なPDFファイルのアップロード
- **WHEN** ユーザーが有効なPDFファイルをアップロードする
- **THEN** システムはファイルを受け付ける
- **AND** 次の処理ステップに進む

#### Scenario: 拡張子を偽装したファイルのアップロード
- **WHEN** ユーザーが拡張子のみを.pdfに変更した非PDFファイルをアップロードする
- **THEN** システムはファイル内容を検証してPDF形式でないことを検出する
- **AND** エラーメッセージを表示してファイルを拒否する

#### Scenario: ファイルサイズ上限超過
- **WHEN** ユーザーが50MBを超えるPDFファイルをアップロードする
- **THEN** システムはファイルを拒否する
- **AND** 「ファイルサイズは50MB以下にしてください」というエラーメッセージを表示する

### Requirement: 書類種別の自動判定
システムは、アップロードされたPDFファイルの書類種別（有価証券報告書、統合報告書、決算短信等）を自動で判定しなければならない（MUST）。

#### Scenario: 有価証券報告書の自動判定
- **WHEN** ユーザーが有価証券報告書のPDFをアップロードする
- **THEN** システムはファイル名と冒頭20ページの内容を解析する
- **AND** 書類種別を「有価証券報告書」と判定する
- **AND** 判定結果をユーザーに表示する

#### Scenario: 統合報告書の自動判定
- **WHEN** ユーザーが統合報告書のPDFをアップロードする
- **THEN** システムは書類種別を「統合報告書」と判定する
- **AND** 判定結果を表示する

#### Scenario: 判定不可能な書類
- **WHEN** ユーザーが判定不可能な書類（例: 一般的なプレゼン資料）をアップロードする
- **THEN** システムは「判定不能」として扱う
- **AND** ユーザーに手動での種別選択を促す

### Requirement: 書類種別の手動修正
システムは、自動判定された書類種別が誤っている場合に、ユーザーが手動で修正できる機能を提供しなければならない（MUST）。

#### Scenario: 誤判定の修正
- **WHEN** システムが書類を「決算短信」と判定したが、実際は「統合報告書」である
- **AND** ユーザーが書類種別を「統合報告書」に手動で変更する
- **THEN** システムは修正後の書類種別を保存する
- **AND** 以降の処理で修正後の種別を使用する

#### Scenario: 判定不能な書類の手動設定
- **WHEN** システムが書類種別を判定できない
- **AND** ユーザーが書類種別リストから「有価証券報告書」を選択する
- **THEN** システムは選択された書類種別を使用する

### Requirement: アップロード進捗の表示
システムは、ファイルアップロードの進捗状況をユーザーに表示しなければならない（MUST）。

#### Scenario: アップロード中の進捗表示
- **WHEN** ユーザーがファイルをアップロード中である
- **THEN** システムはアップロード進捗率（0-100%）をプログレスバーで表示する
- **AND** 現在処理中のファイル名を表示する

#### Scenario: 複数ファイルアップロード時の進捗表示
- **WHEN** ユーザーが3つのファイルを同時にアップロードしている
- **THEN** システムは各ファイルの個別進捗と全体進捗を表示する
- **AND** 完了したファイル数（例: 1/3完了）を表示する

### Requirement: アップロード完了通知
システムは、ファイルのアップロードと初期処理が完了したことをユーザーに通知しなければならない（MUST）。

#### Scenario: 正常完了の通知
- **WHEN** 全てのファイルのアップロードと初期処理が正常に完了する
- **THEN** システムは成功メッセージを表示する
- **AND** 次のステップ（構造化・分析）に自動的に進む

#### Scenario: 一部ファイルの処理失敗
- **WHEN** 3つのファイルのうち1つの処理が失敗する
- **THEN** システムは成功したファイルと失敗したファイルを区別して表示する
- **AND** 失敗したファイルのエラー内容を表示する
- **AND** 成功したファイルのみで処理を続行するオプションを提供する


