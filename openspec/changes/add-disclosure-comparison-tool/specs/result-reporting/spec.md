## ADDED Requirements

### Requirement: サマリーダッシュボード
システムは、分析結果の全体像を示すサマリーダッシュボードを表示しなければならない（MUST）。

#### Scenario: 基本的なサマリー表示
- **WHEN** 比較分析が完了する
- **THEN** システムはサマリーダッシュボードを表示する
- **AND** 以下の情報を含む:
  - 比較した資料の数と種別
  - 検出された差異の総数
  - 数値の不一致件数
  - テキストの差異件数
  - 重要な差異の件数（高優先度）

#### Scenario: ビジュアル要約
- **WHEN** サマリーダッシュボードが表示される
- **THEN** システムは以下のビジュアル要素を含む:
  - 円グラフ（差異の種類別内訳）
  - 棒グラフ（項目別の差異数）
  - ヒートマップ（項目間の類似度マトリックス）

#### Scenario: クイックアクションリンク
- **WHEN** サマリーダッシュボードが表示される
- **THEN** ユーザーは以下のクイックアクションにアクセスできる:
  - 「全ての差異を表示」ボタン
  - 「重要な差異のみ表示」ボタン
  - 「レポートをエクスポート」ボタン

### Requirement: サイド・バイ・サイドビュー
システムは、2つのドキュメントを左右に並べて表示するビューを提供しなければならない（MUST）。

#### Scenario: 2資料の並列表示
- **WHEN** ユーザーが2つの資料を比較している
- **THEN** システムは画面を左右に分割する
- **AND** 左側に資料A、右側に資料Bを表示する
- **AND** 対応する項目が同じ垂直位置に表示されるよう調整する

#### Scenario: 差異箇所のハイライト
- **WHEN** サイド・バイ・サイドビューが表示される
- **THEN** システムは差異がある箇所を色分けしてハイライトする:
  - 赤色: 重要な差異（数値の不一致、意味の大きな違い）
  - 黄色: 中程度の差異（表現の違い）
  - 緑色: 軽微な差異
  - 青色: 追加された内容
  - 灰色: 削除された内容

#### Scenario: 差異箇所のクリックナビゲーション
- **WHEN** ユーザーが差異のハイライト箇所をクリックする
- **THEN** システムは詳細パネルを表示する
- **AND** 差異の種類、重要度、原文の該当テキストを表示する
- **AND** 「次の差異」「前の差異」ボタンでナビゲート可能にする

#### Scenario: 対応項目の視覚的紐付け
- **WHEN** サイド・バイ・サイドビューが表示される
- **THEN** システムは対応する項目同士を線で結ぶ
- **AND** マウスオーバーで線を強調表示する

### Requirement: ページジャンプ機能
システムは、指定したページ番号や項目に即座にジャンプする機能を提供しなければならない（MUST）。

#### Scenario: ページ番号でのジャンプ
- **WHEN** ユーザーがページ番号（例: 25ページ）を入力する
- **THEN** システムは該当ページにスクロールする
- **AND** 左右両方のドキュメントで対応するページを表示する

#### Scenario: 項目名でのジャンプ
- **WHEN** ユーザーが項目名（例: 「事業等のリスク」）を選択する
- **THEN** システムは該当項目の開始ページにジャンプする
- **AND** 項目全体をハイライト表示する

### Requirement: 差分リスト
システムは、検出された差分や不整合を一覧表示しなければならない（MUST）。

#### Scenario: 差分リストの表示
- **WHEN** ユーザーが差分リストを表示する
- **THEN** システムは全ての差分を表形式で表示する
- **AND** 各行に以下の情報を含む:
  - 差異の種類（数値、テキスト、意味的差異等）
  - 重要度（高/中/低）
  - 項目名
  - ページ番号
  - 差異の概要
  - 「詳細を見る」リンク

#### Scenario: 差分リストのフィルタリング
- **WHEN** ユーザーが差分リストをフィルタリングする
- **THEN** システムは以下のフィルタオプションを提供する:
  - 重要度で絞り込み
  - 差異の種類で絞り込み
  - 項目名で絞り込み
  - キーワード検索

#### Scenario: 差分リストのソート
- **WHEN** ユーザーが差分リストをソートする
- **THEN** システムは以下のソートオプションを提供する:
  - 重要度順
  - ページ番号順
  - 項目名順
  - 検出日時順

### Requirement: ドリルダウン機能
システムは、差分リストから原文の該当箇所に直接アクセスできる機能を提供しなければならない（MUST）。

#### Scenario: 差分リストからのドリルダウン
- **WHEN** ユーザーが差分リストの項目をクリックする
- **THEN** システムはサイド・バイ・サイドビューに切り替える
- **AND** 該当箇所を自動的にスクロールして表示する
- **AND** 該当箇所をハイライト表示する

#### Scenario: コンテキスト表示
- **WHEN** ユーザーが差異箇所を詳細表示する
- **THEN** システムは該当箇所の前後のコンテキスト（前後5行程度）も表示する
- **AND** ユーザーが文脈を理解しやすくする

### Requirement: レポート生成
システムは、分析結果をレポート形式で生成しなければならない（MUST）。

#### Scenario: PDFレポートの生成
- **WHEN** ユーザーが「PDFレポート」を選択する
- **THEN** システムは以下の内容を含むPDFレポートを生成する:
  - 表紙（比較対象資料、実行日時）
  - サマリー（差異の総数、重要な発見事項）
  - 詳細な差異リスト
  - 各差異の原文スナップショット
  - 項目別の分析結果

#### Scenario: Excelレポートの生成
- **WHEN** ユーザーが「Excelレポート」を選択する
- **THEN** システムは以下のシートを含むExcelファイルを生成する:
  - サマリーシート
  - 数値差異リスト
  - テキスト差異リスト
  - トピック分析結果
  - 生データ（構造化された比較結果）

#### Scenario: レポートのカスタマイズ
- **WHEN** ユーザーがレポート生成オプションを設定する
- **THEN** システムは以下のオプションを提供する:
  - 含める差異の重要度レベル
  - 含める項目の選択
  - 原文スナップショットの有無
  - レポート言語（日本語/英語）

### Requirement: レポートエクスポート
システムは、生成されたレポートをユーザーがダウンロードできる機能を提供しなければならない（MUST）。

#### Scenario: PDFレポートのダウンロード
- **WHEN** PDFレポートの生成が完了する
- **THEN** システムはダウンロードボタンを表示する
- **AND** ユーザーがボタンをクリックするとPDFがダウンロードされる
- **AND** ファイル名は「比較レポート_YYYYMMDD_HHMMSS.pdf」形式

#### Scenario: Excelレポートのダウンロード
- **WHEN** Excelレポートの生成が完了する
- **THEN** システムはダウンロードボタンを表示する
- **AND** ファイル名は「比較レポート_YYYYMMDD_HHMMSS.xlsx」形式

#### Scenario: レポート生成失敗時のエラーハンドリング
- **WHEN** レポート生成中にエラーが発生する
- **THEN** システムはエラーメッセージを表示する
- **AND** 「再試行」ボタンを提供する

### Requirement: インタラクティブ機能
システムは、結果画面でインタラクティブな操作を提供しなければならない（MUST）。

#### Scenario: ポップアップでの詳細情報表示
- **WHEN** ユーザーが差異箇所にマウスオーバーする
- **THEN** システムはポップアップで詳細情報を表示する:
  - 差異の種類
  - 重要度
  - 簡単な説明
  - 「詳細を見る」リンク

#### Scenario: 差異の受け入れ/却下
- **WHEN** ユーザーが特定の差異を確認する
- **THEN** システムは「この差異を受け入れる」または「無視する」ボタンを提供する
- **AND** ユーザーの判断を記録する
- **AND** 受け入れ/却下した差異をリストから非表示にする（オプション）

### Requirement: レスポンシブデザイン
システムは、様々な画面サイズに対応したレスポンシブデザインを提供しなければならない（MUST）。

#### Scenario: デスクトップでの表示
- **WHEN** ユーザーがデスクトップブラウザで結果を表示する
- **THEN** システムはサイド・バイ・サイドビューを最適に表示する
- **AND** 画面全体を効果的に使用する

#### Scenario: タブレットでの表示
- **WHEN** ユーザーがタブレットで結果を表示する
- **THEN** システムはレイアウトを調整する
- **AND** サイド・バイ・サイドビューを維持するが、文字サイズやボタンを最適化する

#### Scenario: モバイルでの表示
- **WHEN** ユーザーがスマートフォンで結果を表示する
- **THEN** システムはサイド・バイ・サイドビューを上下レイアウトに変更する
- **AND** タッチ操作に最適化したUIを提供する

